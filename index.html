<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Expense Tracker Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      background: linear-gradient(135deg, #89f7fe, #66a6ff);
      color: #2A3A4B;
    }

    .container {
      max-width: 1100px;
      margin: 40px auto;
      padding: 25px;
    }

    h2 {
      text-align: center;
      color: #fff;
      font-size: 32px;
      margin-bottom: 25px;
      text-shadow: 0 3px 6px rgba(0,0,0,0.2);
    }

    /* Dashboard Stats */
    .dashboard {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 30px;
    }

    .stat {
      flex: 1 1 250px;
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(8px);
      border-radius: 15px;
      padding: 25px;
      text-align: center;
      color: #fff;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
      transition: transform 0.2s ease-in-out;
    }

    .stat:hover { transform: translateY(-6px); }

    .stat span {
      display: block;
      font-size: 26px;
      font-weight: bold;
    }
    .stat small {
      display: block;
      margin-top: 8px;
      font-size: 15px;
      opacity: 0.85;
    }

    /* Form */
    form {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      background: rgba(255,255,255,0.2);
      backdrop-filter: blur(8px);
      padding: 18px;
      border-radius: 12px;
      margin-bottom: 30px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    input, select {
      padding: 10px;
      border-radius: 8px;
      border: none;
      flex: 1 1 160px;
      font-size: 14px;
    }

    button {
      background: #3574e0;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 10px 18px;
      cursor: pointer;
      transition: background 0.2s;
    }
    button:hover { background: #245ac6; }
    button.del { background: #e74c3c; }
    button.del:hover { background: #c0392b; }

    /* Charts */
    .charts {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 25px 0;
    }

    canvas {
      background: #fff;
      border-radius: 15px;
      padding: 15px;
      box-shadow: 0 4px 14px rgba(0,0,0,0.1);
    }

    /* Table */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background: #fff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 14px rgba(0,0,0,0.1);
    }

    th, td {
      padding: 12px;
      text-align: center;
      border-bottom: 1px solid #eee;
    }

    th {
      background: #3574e0;
      color: #fff;
      font-weight: 600;
    }

    tr:nth-child(even) { background: #f9fbff; }

    @media (max-width: 800px) {
      .charts { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>üí∞ My Expense Tracker</h2>

    <!-- Dashboard -->
    <div class="dashboard">
      <div class="stat"><span id="totalMonth">‚Çπ0</span><small>This Month</small></div>
      <div class="stat"><span id="totalToday">‚Çπ0</span><small>Today</small></div>
      <div class="stat"><span id="categoryTop">--</span><small>Top Category</small></div>
    </div>

    <!-- Form -->
    <form id="expenseForm" autocomplete="off">
      <input type="date" id="date" required />
      <input type="number" id="amount" placeholder="Amount (‚Çπ)" required />
      <select id="category" required>
        <option value="">Select Category</option>
        <option>Food</option>
        <option>Transport</option>
        <option>Shopping</option>
        <option>Bills</option>
        <option>Other</option>
      </select>
      <input type="text" id="note" placeholder="Note" />
      <button type="submit">‚ûï Add</button>
      <button type="button" onclick="exportCSV()">‚¨áÔ∏è Export</button>
    </form>

    <!-- Charts -->
    <div class="charts">
      <canvas id="categoryChart" height="200"></canvas>
      <canvas id="monthlyChart" height="200"></canvas>
    </div>

    <!-- Expense Table -->
    <table id="expenseTable">
      <thead>
        <tr><th>Date</th><th>Amount</th><th>Category</th><th>Note</th><th>Action</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    let expenses = JSON.parse(localStorage.getItem('expenses') || '[]');
    const colors = { Food:"#FF6B6B", Transport:"#FFD93D", Shopping:"#6C63FF", Bills:"#1DD1A1", Other:"#54a0ff" };

    function renderDashboard() {
      let today = new Date().toISOString().slice(0,10), month = today.slice(0,7);
      let totMonth=0, totToday=0, cats={};
      expenses.forEach(e=>{
        if(e.date?.slice(0,7)==month) totMonth+=+e.amount;
        if(e.date==today) totToday+=+e.amount;
        cats[e.category]=(cats[e.category]||0)+(+e.amount);
      });
      let topCat = Object.keys(cats).length ? Object.entries(cats).reduce((a,b)=>a[1]>b[1]?a:b)[0] : "--";
      document.getElementById("totalMonth").innerText="‚Çπ"+totMonth;
      document.getElementById("totalToday").innerText="‚Çπ"+totToday;
      document.getElementById("categoryTop").innerText=topCat||"--";
    }

    function renderTable() {
      let tbody=document.querySelector('#expenseTable tbody');
      tbody.innerHTML='';
      expenses.forEach((exp,i)=>{
        tbody.innerHTML+=`
          <tr>
            <td>${exp.date}</td>
            <td>‚Çπ${exp.amount}</td>
            <td>${exp.category}</td>
            <td>${exp.note}</td>
            <td><button class="del" onclick="deleteExpense(${i})">Delete</button></td>
          </tr>`;
      });
    }

    function deleteExpense(i) {
      expenses.splice(i,1);
      localStorage.setItem('expenses',JSON.stringify(expenses));
      renderDashboard(); renderTable(); renderCharts();
    }

    document.getElementById("expenseForm").onsubmit=function(e){
      e.preventDefault();
      const dateVal=document.getElementById("date").value;
      const amountVal=document.getElementById("amount").value;
      const categoryVal=document.getElementById("category").value;
      const noteVal=document.getElementById("note").value;

      expenses.push({date:dateVal, amount:amountVal, category:categoryVal, note:noteVal});
      localStorage.setItem('expenses',JSON.stringify(expenses));
      this.reset();
      renderDashboard(); renderTable(); renderCharts();
    }

    function exportCSV() {
      let csv="Date,Amount,Category,Note\n";
      expenses.forEach(e=>{csv+=`${e.date},${e.amount},${e.category},${e.note}\n`});
      let blob=new Blob([csv],{type:'text/csv'}), url=URL.createObjectURL(blob);
      let a=document.createElement('a'); a.href=url; a.download='expenses.csv'; a.click(); URL.revokeObjectURL(url);
    }

    let categoryChart, monthlyChart;
    function renderCharts(){
      // Category chart (Pie)
      let cats={}; expenses.forEach(e=>{cats[e.category]=(cats[e.category]||0)+(+e.amount)});
      let catLabels=Object.keys(cats), catData=catLabels.map(l=>cats[l]), catColors=catLabels.map(l=>colors[l]||"#555");
      let categoryCanvas=document.getElementById('categoryChart');
      if(categoryChart) categoryChart.destroy();
      categoryChart=new Chart(categoryCanvas.getContext('2d'),{
        type:'pie',
        data:{labels:catLabels,datasets:[{data:catData,backgroundColor:catColors}]},
        options:{plugins:{legend:{position:'bottom'}}}
      });

      // Monthly trend (Line)
      let months={}; expenses.forEach(e=>{let m=e.date?.slice(0,7)||""; months[m]=(months[m]||0)+(+e.amount)});
      let monthLabels=Object.keys(months).sort(), monthData=monthLabels.map(m=>months[m]);
      let monthlyCanvas=document.getElementById('monthlyChart');
      if(monthlyChart) monthlyChart.destroy();
      monthlyChart=new Chart(monthlyCanvas.getContext('2d'),{
        type:'line',
        data:{labels:monthLabels,datasets:[{data:monthData,borderColor:"#3574e0",fill:true,backgroundColor:"rgba(53,116,224,0.2)",label:"Monthly Expense"}]},
        options:{scales:{y:{beginAtZero:true}}}
      });
    }

    renderDashboard(); renderTable(); renderCharts();
  </script>
</body>
</html>
